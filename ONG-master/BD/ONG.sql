DROP DATABASE IF EXISTS ONG;
CREATE DATABASE IF NOT EXISTS ONG;
USE ONG;

CREATE TABLE IF NOT EXISTS PERMISSAO (
	ID_PERMISSAO INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(15)
);
CREATE TABLE IF NOT EXISTS LOGIN (
    ID_LOGIN INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(25),
    SENHA VARCHAR(20),
    ENDERECO VARCHAR(40),
    TELEFONE VARCHAR(20),
    EMAIL VARCHAR(25),
    ID_PERMISSAO INT,
    FOREIGN KEY (ID_PERMISSAO)
        REFERENCES PERMISSAO (ID_PERMISSAO)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS ESPECIE (
	ID_ESPECIE INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(25)
);

CREATE TABLE IF NOT EXISTS VETERINARIO (
	ID_VETERINARIO INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(25),
    ENDERECO VARCHAR(40),
    TELEFONE VARCHAR(20),
    CRV INT
);

CREATE TABLE IF NOT EXISTS RACA (
	ID_RACA INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(25),
    ID_ESPECIE INT,
	FOREIGN KEY (ID_ESPECIE)
        REFERENCES ESPECIE (ID_ESPECIE)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS ANIMAL (
    ID_ANIMAL INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(25),
    IDADE VARCHAR(2),
    IMAGEM LONGBLOB,
    OBSERVACAO VARCHAR(50),
    ID_LOGIN INT DEFAULT NULL, 
    ID_RACA INT,
    DATA_ADOCAO DATE DEFAULT NULL,
	FOREIGN KEY (ID_LOGIN)
        REFERENCES LOGIN (ID_LOGIN)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (ID_RACA)
        REFERENCES RACA (ID_RACA)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS HISTORICO_ATENDIMENTO (
	ID_HISTORICO_ATENDIMENTO INT NOT NULL PRIMARY KEY,
    DATA_ATENDIMENTO DATE,
    MEDICACAO VARCHAR(50),
    OBSERVACAO VARCHAR(100),
    ID_ANIMAL INT,
    FOREIGN KEY(ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL)
);

CREATE TABLE IF NOT EXISTS TIPO (
	ID_TIPO INT NOT NULL PRIMARY KEY,
    TIPO_DOACAO VARCHAR(20)
);

CREATE TABLE IF NOT EXISTS DOACAO (
	ID_DOACAO INT NOT NULL PRIMARY KEY,
    DESCRICAO VARCHAR(100),
    QUANTIDADE VARCHAR(10),
    DATA_DOACAO DATE,
    ID_LOGIN INT,
    FOREIGN KEY (ID_LOGIN)
		REFERENCES LOGIN (ID_LOGIN)
        ON UPDATE CASCADE ON DELETE CASCADE,
	ID_TIPO INT,
    FOREIGN KEY (ID_TIPO)
		REFERENCES TIPO (ID_TIPO)
        ON UPDATE CASCADE ON DELETE CASCADE
);


CREATE TABLE IF NOT EXISTS CONSULTA (
	ID_CONSULTA INT NOT NULL PRIMARY KEY,
    ID_ANIMAL INT,
    ID_VETERINARIO INT,
    ID_HISTORICO_ATENDIMENTO INT,
    FOREIGN KEY (ID_ANIMAL)
		REFERENCES ANIMAL (ID_ANIMAL)
		ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (ID_VETERINARIO)
		REFERENCES VETERINARIO (ID_VETERINARIO)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (ID_HISTORICO_ATENDIMENTO)
		REFERENCES HISTORICO_ATENDIMENTO (ID_HISTORICO_ATENDIMENTO)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS POSTAGEM (
	ID_POSTAGEM INT NOT NULL PRIMARY KEY,
    TEXTO VARCHAR(100),
    DATA_POSTAGEM DATE,
    IMAGEM LONGBLOB,
    ID_LOGIN INT,
    FOREIGN KEY (ID_LOGIN)
		REFERENCES LOGIN (ID_LOGIN)
        ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE IF NOT EXISTS COMENTARIO (
	ID_COMENTARIO INT NOT NULL PRIMARY KEY,
    TEXTO VARCHAR(100),
    DATA_COMENTARIO DATE,
    IMAGEM LONGBLOB,
    ID_POSTAGEM INT,
    ID_LOGIN INT,
    FOREIGN KEY (ID_POSTAGEM)
        REFERENCES POSTAGEM (ID_POSTAGEM)
        ON UPDATE CASCADE ON DELETE CASCADE,
	FOREIGN KEY (ID_LOGIN)
        REFERENCES POSTAGEM (ID_LOGIN)
        ON UPDATE CASCADE ON DELETE CASCADE
);

SHOW TABLES;

INSERT INTO PERMISSAO VALUES (1,'Root');
INSERT INTO PERMISSAO VALUES (2,'Veterinario');
INSERT INTO PERMISSAO VALUES (3,'Usuário');
INSERT INTO PERMISSAO VALUES (4,'Premium');

INSERT INTO LOGIN VALUES (1,'Evely Cafe','12345','Av.Mendonza','(16)99999-9999','evely123@gmail.com', 1);
INSERT INTO LOGIN VALUES (2,'Ana Aravecchia','00000','Av.Paulista','(16)99999-8888','anaclara@yahoo.com', 1);
SELECT 
    *
FROM
    LOGIN;
    
INSERT INTO ESPECIE VALUES (10,'Cachorro');
INSERT INTO ESPECIE VALUES (20,'Gato');
INSERT INTO ESPECIE VALUES (30,'Coelho');
INSERT INTO ESPECIE VALUES (40,'Peixe');
INSERT INTO ESPECIE VALUES (50,'Hamster');
SELECT 
    *
FROM
    ESPECIE;
    
INSERT INTO VETERINARIO VALUES (111,'Renata Porto','Rua Benedito Gonsalvez','(16)95555-5555','987654');
INSERT INTO VETERINARIO VALUES (222,'Marcelo Crisciolo','Rua Braz','(16)95555-4444','789456');
INSERT INTO VETERINARIO VALUES (333,'Beluzo Junior','Rua dos Codigos','(16)95555-3333','897564');
SELECT 
    *
FROM
    VETERINARIO;
    
INSERT INTO RACA VALUES (100,'Chihuahua',10);
INSERT INTO RACA VALUES (200,'Persa',20);
INSERT INTO RACA VALUES (300,'Mini Lop',30);
INSERT INTO RACA VALUES (400,'Dourado',40);
INSERT INTO RACA VALUES (500,'Sirio',50);
SELECT 
    *
FROM
    RACA;

INSERT INTO ANIMAL VALUES (600,'Rex','10',null,'Animal com raiva',1,100, '2019-10-30');
INSERT INTO ANIMAL VALUES (700,'Bob','30',null,'Castração do animal',1,300, '2016-10-30'); 
INSERT INTO ANIMAL VALUES (800,'Lili','20',null,'Gripe',2,200, '2017-10-30');
INSERT INTO ANIMAL VALUES (900,'Poli','50',null,'Castração',2,500, '2018-10-30');
SELECT 
    *
FROM
    ANIMAL;

INSERT INTO HISTORICO_ATENDIMENTO VALUES (99,'2019-04-25','Vacina de raiva','Prazo estimado para a próxima dose em cinco meses.', 600);
INSERT INTO HISTORICO_ATENDIMENTO VALUES (88,'2019-10-23','Castração','Repouso por dois dias.', 700);
INSERT INTO HISTORICO_ATENDIMENTO VALUES (77,'2019-04-04','Gripe de coelho','O animal deve tomar os medicamentos conforme prescrevido.', 800);
SELECT 
    *
FROM
    HISTORICO_ATENDIMENTO;

INSERT INTO TIPO VALUES (31,'Pacote de Ração');
INSERT INTO TIPO VALUES (32,'Cobertor');
INSERT INTO TIPO VALUES (33,'Mordedor');
INSERT INTO TIPO VALUES (34,'Aquário');
SELECT 
    *
FROM
    TIPO;
    
INSERT INTO DOACAO VALUES (51,"Ração de Gato", 2,'2019-10-30',1, 31);
INSERT INTO DOACAO VALUES (52,"Ração de Cachorro", 5,'2019-10-30',2, 31);
INSERT INTO DOACAO VALUES (53,"Cobertor pequeno", 10,'2019-10-30',2, 32);
INSERT INTO DOACAO VALUES (54,"Aquário médio", 1,'2019-10-29',1, 34);
SELECT 
    *
FROM
    DOACAO;
    
INSERT INTO CONSULTA VALUES (1111,600,222,99);
INSERT INTO CONSULTA VALUES (2222,800,111,77);
INSERT INTO CONSULTA VALUES (3333,900,333,88);
SELECT 
    *
FROM
    CONSULTA;
    
INSERT INTO POSTAGEM VALUES (61,'Ganhei um novo amigo','2019-10-30',null,1);
INSERT INTO POSTAGEM VALUES (62,'Novo animalzinho a espera de um dono','2019-10-29',null,2);
SELECT 
    *
FROM
    POSTAGEM;
    
INSERT INTO COMENTARIO VALUES (81,'Ele é lindo','2019-10-30',null,61, 1);
INSERT INTO COMENTARIO VALUES (82,'Estou interessada. Como faço para adota-lo','2019-10-29',null,62, 2);
SELECT 
    *
FROM
    COMENTARIO;
